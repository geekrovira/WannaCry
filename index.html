<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Análisis de Malware WannaCry</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Mono&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0F172A; /* Dark Slate Blue */
            color: #E2E8F0; /* Light Gray */
            line-height: 1.6;
        }
        h1, h2, h3, h4 {
            font-weight: 600;
            color: #60A5FA; /* Blue 400 */
        }
        h1 { font-size: 2.5rem; margin-bottom: 1.5rem; }
        h2 { font-size: 2rem; margin-top: 2.5rem; margin-bottom: 1rem; color: #34D399; /* Green 400 */ }
        h3 { font-size: 1.75rem; margin-top: 2rem; margin-bottom: 0.75rem; color: #60A5FA; /* Blue 400 */ }
        h4 { font-size: 1.5rem; margin-top: 1.5rem; margin-bottom: 0.5rem; color: #93C5FD; /* Light Blue 300 */ }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }
        .card {
            background-color: #1E293B; /* Darker Slate Blue */
            border-radius: 0.75rem; /* Rounded corners */
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        pre {
            background-color: #0F172A; /* Even darker for code blocks */
            color: #E2E8F0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            border: 1px solid #334155; /* Slate 700 */
        }
        code {
            font-family: 'Space Mono', monospace;
            background-color: #334155; /* Slate 700 */
            padding: 0.2em 0.4em;
            border-radius: 0.25rem;
            color: #93C5FD;
        }
        a {
            color: #34D399; /* Green 400 */
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .image-container {
            background-color: #0F172A;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap; /* Allow images to wrap on smaller screens */
            gap: 1rem; /* Space between images */
        }
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid #334155;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .tag {
            display: inline-block;
            background-color: #334155; /* Slate 700 */
            color: #93C5FD; /* Light Blue 300 */
            padding: 0.25rem 0.75rem;
            border-radius: 9999px; /* Full rounded */
            font-size: 0.8rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        /* Custom scrollbar for a "Hack The Box" feel */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #1E293B; /* Darker Slate Blue */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #34D399; /* Green 400 */
            border-radius: 10px;
            border: 2px solid #1E293B;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #10B981; /* Green 500 */
        }
    </style>
</head>
<body class="antialiased">
    <div class="container">
        <header class="text-center mb-8">
            <h1 class="text-green-400">Reporte de Análisis de Malware WannaCry</h1>
            <p class="text-gray-400">Análisis Forense y de Comportamiento</p>
            <hr class="border-t border-gray-700 my-4">
        </header>

        <section class="card">
            <h2>1. Resumen Ejecutivo</h2>
            <p>Este informe detalla el análisis de una muestra de ransomware WannaCry, identificada como <code>Ransomware.wannacry.exe.malz</code> (y su ejecutable relacionado <code>lhdfgui.exe</code>). WannaCry es un notorio gusano ransomware de auto-propagación que ganó una atención generalizada en mayo de 2017 debido a su rápida tasa de infección global. Este análisis tiene como objetivo describir sus características técnicas, métodos de propagación, rutinas de cifrado y el impacto general.</p>
        </section>

        <section class="card">
            <h2>2. Información del Archivo y Evaluación Inicial</h2>
            <ul>
                <li><strong>Nombre del Archivo (Observado):</strong> <code>Ransomware.wannacry.exe.malz</code></li>
                <li><strong>Hash de la Muestra Analizada (SHA256 de VirusTotal):</strong> <code>24d00a104e4d54034db0ffc2a4b19a1f39009a575aa014ea04703480b1022c</code> (para <code>lhdfgui.exe</code>)</li>
                <li><strong>Tamaño del Archivo:</strong> 3.55 MB</li>
                <li><strong>Fecha del Último Análisis:</strong> 8 días atrás (según VirusTotal)</li>
                <li><strong>Puntuación de Detección (Comunidad VirusTotal):</strong> 69/71 (con una puntuación comunitaria de -1780, lo que indica una alta maliciosidad).</li>
                <li><strong>Categorías de Amenaza:</strong> <span class="tag">Troyano</span> <span class="tag">Ransomware</span> <span class="tag">Gusano</span></li>
                <li><strong>Etiquetas de Familia:</strong> <span class="tag">Wanna</span> <span class="tag">Wannacry</span> <span class="tag">Wannacryptor</span></li>
            </ul>

            <h3 class="text-blue-400">Confirmación Visual:</h3>
            <div class="image-container">
                <img src="image.png" alt="WannaCry Executable" loading="lazy">
                <img src="image (4).png" alt="VirusTotal Detection Overview" loading="lazy">
            </div>
        </section>

        <section class="card">
            <h2>3. Análisis Técnico</h2>

            <h3>3.1. Características Generales</h3>
            <p>WannaCry opera como un gusano ransomware, lo que significa que cifra los archivos en los sistemas infectados y luego intenta propagarse a otras máquinas vulnerables en la red. Su principal vector de distribución fue la explotación de la vulnerabilidad EternalBlue (CVE-2017-0144 / MS17-010) en el protocolo Server Message Block (SMB) de Microsoft.</p>

            <h3>3.2. Comportamientos Observados (de VirusTotal y confirmados durante el análisis)</h3>
            <p>El análisis de VirusTotal (y el comportamiento típico de WannaCry) indica lo siguiente:</p>
            <div class="flex flex-wrap gap-2 mb-4">
                <span class="tag">PEEXE</span>
                <span class="tag">CVE-2017-0147</span>
                <span class="tag">CVE-2017-0144</span>
                <span class="tag">Malware</span>
                <span class="tag">Checks-user-input</span>
                <span class="tag">Idle</span>
                <span class="tag">Exploit</span>
                <span class="tag">Direct-cpu-clock-access</span>
                <span class="tag">Macro-create-ole</span>
                <span class="tag">Long-sleeps</span>
                <span class="tag">Checks-network-adapters</span>
                <span class="tag">Runtime-modules</span>
                <span class="tag">Detect-debug-environment</span>
            </div>
            <p>Estos comportamientos son consistentes con un malware diseñado para la persistencia, propagación de red y evasión de análisis.</p>

            <h3>3.3. Llamadas a la API Clave y su Significado</h3>
            <p>Durante el análisis, se observaron varias llamadas críticas a la API, lo que indica la funcionalidad del malware:</p>

            <h4>APIs de Gestión de Servicios:</h4>
            <ul>
                <li><code>SetServiceStatus</code>: Se utiliza para actualizar el estado de un servicio, lo que indica que el malware podría operar como un servicio.</li>
                <li><code>OpenSCManagerA</code>: Abre una conexión a la base de datos del Administrador de Control de Servicios, un requisito previo para crear o administrar servicios.</li>
                <li><code>CreateServiceA</code>: Crea una nueva entrada de servicio en la base de datos del Administrador de Control de Servicios. Así es como WannaCry establece la persistencia.</li>
                <li><code>CloseServiceHandle</code>: Cierra un handle a un servicio o al Administrador de Control de Servicios.</li>
                <li><code>StartServiceA</code>: Inicia un servicio existente.</li>
                <li><code>OpenServiceA</code>: Abre un servicio existente.</li>
            </ul>
            <p><em>Significado:</em> Estas llamadas a la API confirman la capacidad de WannaCry para instalarse como un servicio, asegurando la persistencia y la ejecución automática al iniciar el sistema. Esta es una táctica común para que el malware mantenga el control sobre un sistema infectado.</p>

            <h4>APIs de Criptografía (Advapi32.dll):</h4>
            <ul>
                <li><code>CryptGenRandom</code>: Se utiliza para llenar un búfer con bytes criptográficamente aleatorios.
                    <div class="image-container">
                        <img src="image (2).png" alt="CryptGenRandom Documentation" loading="lazy">
                    </div>
                    <em>Significado:</em> Esta función es crucial para generar claves de cifrado para archivos, asegurando que el cifrado sea fuerte y no pueda revertirse fácilmente sin la clave correcta.
                </li>
                <li><code>CryptAcquireContextA</code>: Se utiliza para adquirir un handle a un contenedor de claves particular dentro de un proveedor de servicios criptográficos (CSP).
                    <div class="image-container">
                        <img src="image (1).png" alt="CryptAcquireContextA Documentation" loading="lazy">
                    </div>
                    <em>Significado:</em> Esta función es esencial para establecer un contexto criptográfico, permitiendo que el malware realice operaciones de cifrado y descifrado. Es un paso fundamental en el uso de las funciones criptográficas incorporadas de Windows.
                </li>
            </ul>
            <p><em>Significado:</em> La presencia y el uso de <code>CryptGenRandom</code> y <code>CryptAcquireContextA</code> son fuertes indicadores de las capacidades de cifrado de archivos del malware, confirmando su naturaleza de ransomware.</p>

            <h4 class="text-blue-400">Secuencia de Llamadas a la API Observadas (de análisis dinámico/desensamblado):</h4>
            <div class="image-container">
                <img src="image (3).png" alt="API Call Table" loading="lazy">
            </div>
        </section>

        <section class="card">
            <h2>4. Análisis de Cadenas (Strings)</h2>
            <p>Las cadenas extraídas del binario del malware proporcionan información valiosa sobre su funcionalidad, configuración y posibles comunicaciones de red.</p>
            <pre><code>Strings
/K__USERID__PLACEHOLDER__
PC NETWORK PROGRAM 1.0
LANMAN1.0
Windows for Workgroups 3.1a
LM1.2X002
LANMAN2.1
NT LM 0.12
Windows 2000 2195
Windows 2000 5.0
\192.168.56.20\IPC$
(null)
mscoree.dll
HH:mm:ss
dddd, MMMM dd, yyyy
MM/dd/yy
December
November
October
September
August
February
January
Saturday
Friday
Thursday
Wednesday
Tuesday
Monday
Sunday
runtime error
TLOSS error
SING error
DOMAIN error

Attempt to use MSIL code from this assembly during native code initialization
This indicates a bug in your application. It is most likely the result of calling an MSIL-compiled (/clr) function from a native constructor or from DllMain.
not enough space for locale information
Attempt to initialize the CRT more than once.
This indicates a bug in your application.
msg/m_chinese (traditional).wnry
msg/m_croatian.wnry
msg/m_czech.wnry
msg/m_danish.wnry
msg/m_dutch.wnry
msg/m_english.wnry
msg/m_filipino.wnry
msg/m_finnish.wnry
msg/m_french.wnry
msg/m_german.wnry
msg/m_greek.wnry
msg/m_indonesian.wnry
msg/m_italian.wnry
msg/m_japanese.wnry
msg/m_korean.wnry
msg/m_latvian.wnry
msg/m_norwegian.wnry
msg/m_polish.wnry
msg/m_portuguese.wnry
msg/m_romanian.wnry
msg/m_russian.wnry
msg/m_slovak.wnry
msg/m_spanish.wnry
msg/m_swedish.wnry
msg/m_turkish.wnry
msg/m_vietnamese.wnry
inflate 1.1.3 Copyright 1995-1998 Mark Adler
Qkkbal

unzip 0.15 Copyright 1998 Gilles Vollant
http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</code></pre>

            <h3 class="text-blue-400">Observaciones Clave de las Cadenas:</h3>
            <ul>
                <li><strong>Referencias de Protocolo de Red y SMB:</strong> "PC NETWORK PROGRAM 1.0", "LANMAN1.0", "Windows for Workgroups 3.1a", "LM1.2X002", "LANMAN2.1", "NT LM 0.12", "\192.168.56.20\IPC$". Estas cadenas indican fuertemente el uso de protocolos SMB (Server Message Block) para la comunicación de red y, probablemente, para el movimiento lateral/propagación dentro de una red. La dirección IP <code>192.168.56.20</code> podría ser un C2 interno codificado o un marcador de posición para el escaneo.</li>
                <li><strong>Referencias del Sistema Operativo:</strong> "Windows 2000 2195", "Windows 2000 5.0". Esto sugiere que el malware está diseñado para operar y, potencialmente, atacar varias versiones del sistema operativo Windows, incluidas las más antiguas.</li>
                <li><strong>Formatos de Hora y Fecha:</strong> "HH:mm:ss", "dddd, MMMM dd, yyyy", "MM/dd/yy", junto con los nombres de los meses y días. Esto indica que el malware podría estar marcando eventos con la hora, estableciendo plazos para el rescate o utilizando funciones de fecha/hora específicas de la configuración regional.</li>
                <li><strong>Mensajes de Error:</strong> "runtime error", "TLOSS error", "SING error", "DOMAIN error", "Attempt to use MSIL code...", "not enough space for locale information", "Attempt to initialize the CRT more than once.". Estos son mensajes de error comunes del sistema o de la aplicación, que podrían mostrarse durante la ejecución o ser remanentes del entorno de desarrollo.</li>
                <li><strong>Notas de Rescate Multilingües:</strong> "msg/m_chinese (traditional).wnry", "msg/m_croatian.wnry", etc. Este es un hallazgo crucial, que indica que WannaCry muestra notas de rescate en varios idiomas para atender a una base de víctimas global. La extensión <code>.wnry</code> es característica de los archivos de nota de rescate de WannaCry.</li>
                <li><strong>Librerías de Compresión:</strong> "inflate 1.1.3 Copyright 1995-1998 Mark Adler", "unzip 0.15 Copyright 1998 Gilles Vollant". Estas cadenas sugieren que el malware podría estar utilizando librerías de compresión, posiblemente para descomprimir sus propios componentes o para comprimir datos antes de la exfiltración (aunque la exfiltración no es su función principal, es una capacidad general del malware).</li>
                <li><strong>Dominio de "Kill Switch":</strong> <a href="http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com" target="_blank" class="text-green-400 hover:text-green-300"><code>http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</code></a>. Este es el infame dominio de "kill switch" descubierto por Marcus Hutchins (MalwareTech). Si el malware puede conectarse con éxito a este dominio, termina su actividad maliciosa, evitando así un mayor cifrado y propagación. Esta fue una vulnerabilidad crítica en WannaCry que permitió a los investigadores ralentizar significativamente su propagación.</li>
            </ul>
        </section>

        <section class="card">
            <h2>5. Propagación e Impacto</h2>
            <p>WannaCry se propagó principalmente explotando la vulnerabilidad EternalBlue (CVE-2017-0144) en sistemas Windows sin parches. Una vez que un sistema estaba infectado, intentaba escanear e infectar otras máquinas vulnerables en la red local y a través de Internet. El impacto fue severo, lo que provocó una interrupción generalizada de los servicios, particularmente en los sectores de atención médica, telecomunicaciones y manufactura a nivel mundial.</p>
        </section>

        <section class="card">
            <h2>6. Mitigación y Recomendaciones</h2>
            <p>Para protegerse contra WannaCry y amenazas similares:</p>
            <ul>
                <li><strong>Parchear Sistemas Inmediatamente:</strong> Asegúrese de que todos los sistemas operativos y el software se mantengan actualizados con los últimos parches de seguridad, especialmente aquellos que abordan las vulnerabilidades de SMB (por ejemplo, MS17-010).</li>
                <li><strong>Deshabilitar SMBv1:</strong> Si no es necesario, deshabilite SMBv1, ya que hay versiones más nuevas y seguras (SMBv2/v3) disponibles.</li>
                <li><strong>Segmentación de Red:</strong> Segmente las redes para limitar el movimiento lateral del malware en caso de una infección.</li>
                <li><strong>Antivirus/Detección y Respuesta de Puntos Finales (EDR) Robustos:</strong> Implemente y mantenga soluciones de seguridad robustas que puedan detectar y bloquear malware conocido.</li>
                <li><strong>Copias de Seguridad Regulares:</strong> Implemente una estrategia integral de copias de seguridad, almacenando datos críticos fuera de línea o en sistemas separados y seguros, para permitir la recuperación en caso de un ataque de ransomware.</li>
                <li><strong>Reglas de Firewall:</strong> Bloquee las conexiones entrantes y salientes en los puertos comúnmente utilizados por SMB (139, 445) en el perímetro de la red, a menos que sea absolutamente necesario.</li>
                <li><strong>Educación del Usuario:</strong> Capacite a los usuarios para que desconfíen de correos electrónicos, archivos adjuntos y enlaces sospechosos, ya que el phishing puede ser un vector de infección inicial para muchos tipos de malware.</li>
            </ul>
        </section>

        <section class="card">
            <h2>7. Conclusión</h2>
            <p>WannaCry sirvió como un claro recordatorio de la importancia crítica de la aplicación oportuna de parches y las prácticas sólidas de ciberseguridad. Su rápida propagación global subrayó la interconexión de los sistemas y el potencial de interrupciones graves a partir de incluso vulnerabilidades únicas. La vigilancia continua y la adhesión a las mejores prácticas de seguridad son primordiales para defenderse contra amenazas tan sofisticadas.</p>
        </section>

        <footer class="text-center text-gray-500 text-sm mt-8 py-4 border-t border-gray-700">
            <p>&copy; 2025 geekrovira.</p>
            <p>Reporte de Análisis de Ciberseguridad</p>
        </footer>
    </div>
</body>
</html>
